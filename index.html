<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Driver Attendance</title>
</head>
<body style="font-family:sans-serif;text-align:center;">
  <h3>Driver Attendance</h3>
  <p>Please allow location access</p>
  <button onclick="mark()">Mark Attendance</button>

  <script>
    const params = new URLSearchParams(window.location.search);
    const STORE = params.get("store");
    const DRIVER = params.get("driver");

    function mark() {
      if (!STORE || !DRIVER) {
        alert("Invalid QR");
        return;
      }

      navigator.geolocation.getCurrentPosition(
        function(pos) {
          fetch("https://script.google.com/macros/s/AKfycbw9oJN0SVL4O313dHbdsG2eSA2X4kxbO_b74-zgd8JFQoXrMWl-gVZqXjrhGzUcz8lJ/exec",{
  method: "POST",
  mode: "no-cors",
  headers: {
    "Content-Type": "text/plain"
  },
  body: JSON.stringify({
    store: STORE,
    driver: DRIVER,
    lat: pos.coords.latitude,
    lng: pos.coords.longitude
  })
})
.then(() => alert("Attendance recorded"))
.catch(() => alert("Unable to mark attendance")
      );
    }
  </script>
</body>
</html>
